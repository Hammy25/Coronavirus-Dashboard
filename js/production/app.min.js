!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.NProgress=e()}(this,function(){var t,e,a={version:"0.2.0"},r=a.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function s(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName}function n(t,e,a){return t<e?e:t>a?a:t}function i(t){return 100*(-1+t)}a.configure=function(t){var e,a;for(e in t)void 0!==(a=t[e])&&t.hasOwnProperty(e)&&(r[e]=a);return this},a.status=null,a.set=function(t){var e=a.isStarted();t=n(t,r.minimum,1),a.status=1===t?null:t;var s=a.render(!e),c=s.querySelector(r.barSelector),d=r.speed,p=r.easing;return s.offsetWidth,o(function(e){""===r.positionUsing&&(r.positionUsing=a.getPositioningCSS()),l(c,function(t,e,a){var s;s="translate3d"===r.positionUsing?{transform:"translate3d("+i(t)+"%,0,0)"}:"translate"===r.positionUsing?{transform:"translate("+i(t)+"%,0)"}:{"margin-left":i(t)+"%"};return s.transition="all "+e+"ms "+a,s}(t,d,p)),1===t?(l(s,{transition:"none",opacity:1}),s.offsetWidth,setTimeout(function(){l(s,{transition:"all "+d+"ms linear",opacity:0}),setTimeout(function(){a.remove(),e()},d)},d)):setTimeout(e,d)}),this},a.isStarted=function(){return"number"==typeof a.status},a.start=function(){a.status||a.set(0);var t=function(){setTimeout(function(){a.status&&(a.trickle(),t())},r.trickleSpeed)};return r.trickle&&t(),this},a.done=function(t){return t||a.status?a.inc(.3+.5*Math.random()).set(1):this},a.inc=function(t){var e=a.status;return e?e>1?void 0:("number"!=typeof t&&(t=e>=0&&e<.2?.1:e>=.2&&e<.5?.04:e>=.5&&e<.8?.02:e>=.8&&e<.99?.005:0),e=n(e+t,0,.994),a.set(e)):a.start()},a.trickle=function(){return a.inc()},t=0,e=0,a.promise=function(r){return r&&"resolved"!==r.state()?(0===e&&a.start(),t++,e++,r.always(function(){0==--e?(t=0,a.done()):a.set((t-e)/t)}),this):this},a.render=function(t){if(a.isRendered())return document.getElementById("nprogress");d(document.documentElement,"nprogress-busy");var e=document.createElement("div");e.id="nprogress",e.innerHTML=r.template;var n,o=e.querySelector(r.barSelector),c=t?"-100":i(a.status||0),p=s(r.parent)?r.parent:document.querySelector(r.parent);return l(o,{transition:"all 0 linear",transform:"translate3d("+c+"%,0,0)"}),r.showSpinner||(n=e.querySelector(r.spinnerSelector))&&u(n),p!=document.body&&d(p,"nprogress-custom-parent"),p.appendChild(e),e},a.remove=function(){p(document.documentElement,"nprogress-busy"),p(s(r.parent)?r.parent:document.querySelector(r.parent),"nprogress-custom-parent");var t=document.getElementById("nprogress");t&&u(t)},a.isRendered=function(){return!!document.getElementById("nprogress")},a.getPositioningCSS=function(){var t=document.body.style,e="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return e+"Perspective"in t?"translate3d":e+"Transform"in t?"translate":"margin"};var o=function(){var t=[];function e(){var a=t.shift();a&&a(e)}return function(a){t.push(a),1==t.length&&e()}}(),l=function(){var t=["Webkit","O","Moz","ms"],e={};function a(a){return a=a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()}),e[a]||(e[a]=function(e){var a=document.body.style;if(e in a)return e;for(var r,s=t.length,n=e.charAt(0).toUpperCase()+e.slice(1);s--;)if((r=t[s]+n)in a)return r;return e}(a))}function r(t,e,r){e=a(e),t.style[e]=r}return function(t,e){var a,s,n=arguments;if(2==n.length)for(a in e)void 0!==(s=e[a])&&e.hasOwnProperty(a)&&r(t,a,s);else r(t,n[1],n[2])}}();function c(t,e){return("string"==typeof t?t:m(t)).indexOf(" "+e+" ")>=0}function d(t,e){var a=m(t),r=a+e;c(a,e)||(t.className=r.substring(1))}function p(t,e){var a,r=m(t);c(t,e)&&(a=r.replace(" "+e+" "," "),t.className=a.substring(1,a.length-1))}function m(t){return(" "+(t&&t.className||"")+" ").replace(/\s+/gi," ")}function u(t){t&&t.parentNode&&t.parentNode.removeChild(t)}return a});class BarChart{constructor(t,e,a){this.parentElement=t,this.svgWidth=e,this.svgHeight=a,this.initializeChart()}initializeChart(){const t=this;t.margin={top:50,right:50,bottom:50,left:50},t.width=t.svgWidth-t.margin.left-t.margin.right,t.height=t.svgHeight-t.margin.top-t.margin.bottom,t.t=(()=>d3.transition().duration(1e3)),t.svg=d3.select(t.parentElement).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+t.svgWidth+" "+t.svgHeight).classed(".svg-content",!0),t.g=t.svg.append("g").attr("class","bar-chart").attr("width",t.width).attr("height",t.height).attr("transform","translate("+t.margin.left+","+t.margin.top+")"),t.xScale=d3.scaleTime().range([0,t.width]),t.yScale=d3.scaleLinear().range([t.height,0]),t.xAxis=t.g.append("g").attr("transform","translate(0, "+t.height+")"),t.yAxis=t.g.append("g"),t.wrangleData()}wrangleData(t){const e=this;e.key=$("#var-select").val(),e.code=$("#country-select").val(),e.data=formatData(null!=t?allCases[e.code].data.filter(function(e){return e.date>t[0]&&e.date<t[1]}):allCases[e.code].data),e.titleText=determineTitle(e.key),e.y_data=e.data.map(t=>t[e.key]),e.x_data=e.data.map(t=>t.date),e.updateChart()}updateChart(){const t=this;t.xScale.domain(d3.extent(t.x_data)),t.yScale.domain([0,d3.max(t.y_data)+10]),t.xAxis.transition(t.t()).call(d3.axisBottom(t.xScale).ticks(10).tickFormat(d3.timeFormat("%d %b"))),t.yAxis.transition(t.t()).call(d3.axisLeft(t.yScale)),t.xAxis.selectAll("text").attr("class","text-muted").style("font-family","cursive, sans-serif").style("font-size","0.35rem"),t.yAxis.selectAll("text").attr("class","text-muted").style("font-family","cursive, sans-serif").style("font-size","0.35rem"),t.svg.select(".barTitle").remove(),t.heading=t.svg.append("g").attr("transform","translate("+t.width/2+", "+t.margin.top/2+")").append("text").attr("class","barTitle").attr("text-anchor","center").text(t.titleText),t.svg.select("#y-label").remove(),t.yaxisLabel=t.svg.append("text").attr("id","y-label").attr("transform","rotate(-90)").attr("x",0-(t.height+t.margin.top+t.margin.bottom)/2).attr("y",t.margin.left/4).attr("font-size","0.5rem").attr("text-anchor","middle").text(t.titleText),t.bars=t.g.selectAll(".bar").data(t.data),t.bars.exit().remove(),t.bars.attr("class","bar").attr("fill-opacity",.8).attr("ry",.5).attr("x",e=>t.xScale(e.date)).attr("y",e=>t.yScale(e[t.key])).attr("height",e=>t.height-t.yScale(e[t.key])).attr("width",t.width/t.data.length),t.bars.enter().append("rect").attr("class","bar").attr("fill","#4285F4").attr("fill-opacity",.8).attr("ry",.5).attr("x",e=>t.xScale(e.date)).attr("y",e=>t.yScale(e[t.key])).attr("width",t.width/t.data.length).attr("height",e=>t.height-t.yScale(e[t.key])).on("mouseover",e=>{const a=d3.select(event.currentTarget);a.attr("fill-opacity",1),a.attr("stroke","black"),a.attr("stroke-width",.5),toolTip.style("visibility","visible"),toolTip.html(()=>'<span class="tooltip-label">Date: </span>'+formatTime(e.date)+'<br><span class="tooltip-label">'+t.titleText+": </span>"+numbersWithCommas(e[t.key])+"<br>"),toolTip.style("left",d3.event.pageX-150+"px"),toolTip.style("top",d3.event.pageY+"px")}).on("mouseout",t=>{const e=d3.select(event.currentTarget);toolTip.style("visibility","hidden"),e.attr("fill-opacity",.8),e.attr("stroke","none")})}}class Timeline{constructor(t,e,a){this.parentElement=t,this.svgWidth=e,this.svgHeight=a,this.intializeChart()}intializeChart(){const t=this;t.margin={top:0,right:50,bottom:30,left:50},t.height=t.svgHeight-t.margin.top-t.margin.bottom,t.width=t.svgWidth-t.margin.left-t.margin.right,t.svg=d3.select(t.parentElement).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+t.svgWidth+" "+t.svgHeight).classed(".svg-content",!0),t.t=(()=>d3.transition().duration(1e3)),t.g=t.svg.append("g").attr("fill-opacity",.7).attr("transform","translate("+t.margin.left+","+t.margin.top+")"),t.x=d3.scaleTime().range([0,t.width]),t.y=d3.scaleLinear().range([t.height,0]),t.xAxisDates=d3.axisBottom().ticks(3),t.xAxis=t.g.append("g").attr("class","x axis").attr("transform","translate(0,"+t.height+")"),t.areaPath=t.g.append("path").attr("fill","#ccc"),t.brush=d3.brushX().handleSize(10).extent([[0,0],[t.width,t.height]]).on("brush end",brushed),t.brushComponent=t.g.append("g").attr("class","brush").call(t.brush),t.wrangleData()}wrangleData(){var t=this;t.variable=$("#var-select").val(),t.country=$("#country-select").val(),t.dayNest=d3.nest().key(t=>t.date).entries(allCases[t.country].data),t.dataFiltered=t.dayNest.map(function(e){return{date:e.key,sum:e.values.reduce(function(e,a){return e+a[t.variable]},0)}}),t.dataFiltered=t.dataFiltered.filter(t=>t.sum>0),t.updateChart()}updateChart(){const t=this;t.x.domain(d3.extent(t.dataFiltered,t=>new Date(t.date))),t.y.domain([0,d3.max(t.dataFiltered,t=>t.sum)]),t.xAxisDates.scale(t.x),t.xAxis.transition(t.t()).call(t.xAxisDates),t.area0=d3.area().x(e=>t.x(new Date(e.date))).y0(t.height).y1(t.height),t.area=d3.area().x(e=>t.x(new Date(e.date))).y0(t.height).y1(e=>t.y(e.sum)),t.areaPath.data([t.dataFiltered]).attr("d",t.area)}}class TimeSeries{constructor(t,e,a){this.parentElement=t,this.svgWidth=e,this.svgHeight=a,this.initializeChart()}initializeChart(){const t=this;t.margin={top:0,right:50,bottom:50,left:30},t.width=t.svgWidth-t.margin.right-t.margin.left,t.height=t.svgHeight-t.margin.top-t.margin.bottom,t.svg=d3.select("#time-series").append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+t.svgWidth+" "+t.svgHeight).classed(".svg-content",!0),t.t=(()=>d3.transition().duration(1e3)),t.heading=t.svg.append("g").attr("transform","translate("+t.svgWidth/3+", "+t.margin.bottom/2+")").append("text").attr("class","barTitle").attr("text-anchor","center").text("Total Deaths Against Total Cases"),t.g=t.svg.append("g").attr("class","time-series-chart").attr("width",t.width).attr("height",t.height).attr("transform","translate("+t.margin.left+","+t.margin.top+")"),t.xAxisText=t.g.append("text").attr("class","x axis-label").attr("x",(t.svgWidth-t.margin.left-t.margin.right)/2).attr("y",t.svgHeight-t.margin.bottom/4).attr("text-anchor","middle").style("font-size","0.5rem").text("Total Cases"),t.yAxisText=t.g.append("text").attr("transform","rotate(-90)").attr("y",0-t.margin.left/2).attr("x",0-(t.svgHeight-t.margin.top-t.margin.bottom)/2).attr("dy","1em").style("text-anchor","middle").style("font-size","0.5rem").text("Total Deaths"),t.xScale=d3.scaleLinear().range([t.margin.left,t.width]),t.yScale=d3.scaleLinear().range([t.height,t.margin.bottom]),t.radiusScale=d3.scaleLinear().range([2,20]),t.continentColor=d3.scaleOrdinal().range(d3.schemeCategory10),t.xAxisGroup=t.g.append("g").attr("class","x axis").attr("transform","translate(0, "+(t.svgHeight-t.margin.bottom)+")"),t.yAxisGroup=t.g.append("g").attr("class","y axis").attr("transform","translate("+t.margin.left+",0)"),t.wrangleData()}wrangleData(){const t=this;switch(t.totalCases=[],t.deaths=[],t.continents=[],t.population=[],wrkData.forEach(e=>{t.continents.indexOf(e.continent)<0&&t.continents.push(e.continent)}),t.chosenDate=$("#time-series-date-select").val(),t.chosenContinent=$("#time-series-continent-select").val(),t.chosenContinent){case"Asia":t.data=wrkData.filter(t=>"Asia"==t.continent);break;case"Africa":t.data=wrkData.filter(t=>"Africa"==t.continent);break;case"Europe":t.data=wrkData.filter(t=>"Europe"==t.continent);break;case"North America":t.data=wrkData.filter(t=>"North America"==t.continent);break;case"South America":t.data=wrkData.filter(t=>"South America"==t.continent);break;case"Oceania":t.data=wrkData.filter(t=>"Oceania"==t.continent);break;default:t.data=wrkData}t.data.forEach(e=>{t.population.push(e.population),e.cases.map(e=>{t.deaths.indexOf(e.total_deaths)<0&&e.date==t.chosenDate&&t.deaths.push(e.total_deaths)}),e.cases.map(e=>{t.totalCases.indexOf(e.total_cases)<0&&e.date==t.chosenDate&&t.totalCases.push(e.total_cases)})}),t.updateChart()}updateChart(){const t=this;t.continentColor.domain(t.continents),t.radiusScale.domain(d3.extent(t.population)),t.xScale.domain([0,d3.max(t.totalCases)]),t.yScale.domain([0,d3.max(t.deaths)]),t.xAxis=d3.axisBottom(t.xScale).ticks(5),t.yAxis=d3.axisLeft(t.yScale),t.xAxisGroup.transition(t.t()).call(t.xAxis),t.yAxisGroup.transition(t.t()).call(t.yAxis),t.xAxisGroup.selectAll("text").attr("class","text-muted").style("font-family","cursive, sans-serif").style("font-size","0.35rem"),t.yAxisGroup.selectAll("text").attr("class","text-muted").style("font-family","cursive, sans-serif").style("font-size","0.35rem"),t.circles=t.g.selectAll("circle").data(t.data),t.circles.exit().remove(),t.circles.enter().append("circle").attr("fill-opacity",.7).attr("data-country",t=>t.country).attr("data-deaths",e=>{let a=e.cases.filter(e=>e.date==t.chosenDate);return a.length>0?t.yScale(a[0].total_deaths):0}).attr("data-cases",e=>{const a=e.cases.filter(e=>e.date==t.chosenDate);return a.length>0?t.yScale(a[0].total_cases):null}).attr("stroke","grey").on("mouseover",e=>{const a=e.cases.filter(e=>e.date==t.chosenDate),r=d3.select(event.currentTarget);r.attr("fill-opacity",1),r.attr("stroke","black"),r.attr("stroke-width",1),toolTip.style("visibility","visible"),toolTip.style("text-align","left"),toolTip.html(()=>'<span class="tooltip-label">Continent: </span>'+e.continent+'<br><span class="tooltip-label">Country Code: </span>'+e.country_code+'<br><span class="tooltip-label">Country: </span>'+e.country+'<br><span class="tooltip-label">Date: </span>'+a[0].date+'<br><span class="tooltip-label">Population: </span>'+numbersWithCommas(e.population)+'<br><span class="tooltip-label">Total Cases: </span>'+numbersWithCommas(a[0].total_cases)+'<br><span class="tooltip-label">Total Deaths: </span>'+numbersWithCommas(a[0].total_deaths)+"<br>"),toolTip.style("left",d3.event.pageX+"px"),toolTip.style("top",d3.event.pageY+"px")}).on("mouseout",function(t){var e=d3.select(event.currentTarget);toolTip.style("visibility","hidden"),e.attr("fill-opacity",.7),e.attr("stroke","grey")}).merge(t.circles).transition(t.t()).attr("cx",e=>{const a=e.cases.filter(e=>e.date==t.chosenDate);return a.length>0?t.xScale(a[0].total_cases):null}).attr("cy",e=>{const a=e.cases.filter(e=>e.date==t.chosenDate);return a.length>0?t.yScale(a[0].total_deaths):null}).attr("r",e=>{const a=e.cases.filter(e=>e.date==t.chosenDate);return null!=e.cases.filter(e=>e.date==t.chosenDate)[0]&&null!=a[0]?t.radiusScale(e.population):0}).attr("fill",e=>t.continentColor(e.continent)),d3.select("#timeseries-legend").remove(),t.legend=t.g.append("g").attr("id","timeseries-legend").attr("transform","translate("+(t.svgWidth-t.margin.right+5)+","+(t.svgHeight-t.margin.bottom-125)+")"),t.continents.forEach((e,a)=>{const r=t.legend.append("g").attr("transform","translate(0, "+20*a+")");r.append("rect").attr("width",10).attr("height",10).attr("fill",t.continentColor(e)).attr("stroke","grey").attr("fill-opacity",.6),r.append("text").attr("x",-2).attr("y",10).attr("text-anchor","end").attr("class","text-muted").style("text-transform","capitalize").style("font-family","cursive, sans-serif").style("font-size","0.35rem").text(e)})}filterCountry(t){const e=this;e.data=e.data.filter(e=>e.country==t),e.circles=e.g.selectAll("circle").data(e.data),e.circles.exit().remove(),e.circles.enter().append("circle").attr("fill-opacity",.7).attr("data-country",t=>t.country).attr("data-deaths",t=>{const a=t.cases.filter(t=>t.date==e.chosenDate);return a.length>0?a[0].total_deaths:0}).attr("data-cases",t=>{const a=t.cases.filter(t=>t.date==e.chosenDate);return a.length>0?a[0].total_cases:0}).attr("stroke","grey").on("mouseover",t=>{const a=t.cases.filter(t=>t.date==e.chosenDate),r=d3.select(event.currentTarget);r.attr("fill-opacity",1),r.attr("stroke","black"),r.attr("stroke-width",1),toolTip.style("visibility","visible"),toolTip.style("text-align","left"),toolTip.html(()=>'<span class="tooltip-label">Continent: </span>'+t.continent+'<br><span class="tooltip-label">Country Code: </span>'+t.country_code+'<br><span class="tooltip-label">Country: </span>'+t.country+'<br><span class="tooltip-label">Date: </span>'+a[0].date+'<br><span class="tooltip-label">Population: </span>'+numbersWithCommas(t.population)+'<br><span class="tooltip-label">Total Cases: </span>'+numbersWithCommas(a[0].total_cases)+'<br><span class="tooltip-label">Total Deaths: </span>'+numbersWithCommas(a[0].total_deaths)+"<br>"),toolTip.style("left",d3.event.pageX+"px"),toolTip.style("top",d3.event.pageY+"px")}).on("mouseout",function(t){const e=d3.select(event.currentTarget);toolTip.style("visibility","hidden"),e.attr("fill-opacity",.7),e.attr("stroke","grey")}).merge(e.circles).transition(e.t()).attr("cx",t=>{const a=t.cases.filter(t=>t.date==e.chosenDate);return a.length>0?e.xScale(a[0].total_cases):null}).attr("cy",t=>{const a=t.cases.filter(t=>t.date==e.chosenDate);return a.length>0?e.yScale(a[0].total_deaths):null}).attr("r",t=>{const a=t.cases.filter(t=>t.date==e.chosenDate);return null!=t.cases.filter(t=>t.date==e.chosenDate)[0]&&null!=a[0]?e.radiusScale(t.population):0}).attr("fill",t=>e.continentColor(t.continent))}}class KenyaMap{constructor(t,e,a){this.parentElement=t,this.width=e,this.height=a,this.initializeChart()}initializeChart(){const t=this;t.svg=d3.select(t.parentElement).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+t.width+" "+t.height).attr("id","map-canvas").classed(".svg-content",!0),t.radiusScale=d3.scaleLinear().range([4,50]),t.projection=d3.geoMercator().center([37.9062,.0236]).scale(3100).translate([t.width/2,t.height/2]),t.geoGenerator=d3.geoPath().projection(t.projection),t.wrangleData()}wrangleData(){const t=this,e=covid_data.columns;t.values=[],t.date=$("#kenya-date").val(),covid_data.forEach(a=>{for(let r=0;r<e.length;r++)"County"!=e[r]&&(a[e[r]]=+a[e[r]],-1===t.values.indexOf(a[e[r]])&&"Total"!=a.County&&t.values.push(a[e[r]]))}),t.totalValCases=covid_data.map(t=>{let e={},a=0;if(Object.keys(t).forEach(e=>{"County"!=e&&(a+=t[e])}),"Total"!=t.County){return e={county:t.County,cases:a}}}),t.totalValCases=t.totalValCases.filter(t=>null!=t),$("#county-name").text(t.totalValCases[0].county.toUpperCase()),$("#county-cases").text(t.totalValCases[0].cases),t.updateChart()}updateChart(){const t=this;t.radiusVals=t.totalValCases.map(t=>t.cases),t.radiusScale.domain([d3.min(t.radiusVals),d3.max(t.radiusVals)]),t.dataJoin=t.svg.selectAll("path").data(topojson.feature(kenyaMapData,kenyaMapData.objects.counties).features),t.bubblesData=topojson.feature(kenyaMapData,kenyaMapData.objects.counties).features,t.dataJoin.exit().remove(),t.dataJoin.attr("class","county").attr("d",t.geoGenerator).attr("data-county",t=>t.properties.COUNTY_NAM).attr("data-date",$("#kenya-date").val()).attr("data-county-code",t=>{if(t.properties.COUNTY_COD>0)return t.properties.COUNTY_COD}).attr("fill",e=>{if(null!=e.properties.COUNTY_NAM&&e.properties.COUNTY_COD>0){const a=covid_data.filter(t=>t.County.toUpperCase()===e.properties.COUNTY_NAM),r=a[0][t.date];if("Total"!=a[0])return t.colorScale(r)}}).attr("data-cases",e=>{if(null!=e.properties.COUNTY_NAM&&e.properties.COUNTY_COD>0){covid_data.filter(t=>t.County.toUpperCase()===e.properties.COUNTY_NAM)[0][t.date]}return value}),t.dataJoin.enter().append("path").attr("class","county").attr("d",t.geoGenerator).attr("stroke","rgba(255, 0, 0, 0.3)").attr("stroke-width",1).attr("data-county",t=>t.properties.COUNTY_NAM).attr("data-date",$("#kenya-date").val()).attr("data-county-code",t=>{if(t.properties.COUNTY_COD>0)return t.properties.COUNTY_COD}).attr("data-cases",e=>{let a=0;if(null!=e.properties.COUNTY_NAM&&e.properties.COUNTY_COD>0){a=covid_data.filter(t=>t.County.toUpperCase()===e.properties.COUNTY_NAM)[0][t.date]}return a}).attr("fill","white"),t.bubbles=t.svg.selectAll(".bubbles").data(t.bubblesData).enter().append("circle").attr("class","bubbles").attr("r",e=>{if(null!=e.properties.COUNTY_NAM&&e.properties.COUNTY_COD>0){const a=t.totalValCases.filter(t=>t.county.toUpperCase()===e.properties.COUNTY_NAM),r=a[0].cases;if("Total"!=a[0])return t.radiusScale(r)}}).attr("cx",function(e){return t.geoGenerator.centroid(e)[0]}).attr("cy",function(e){return t.geoGenerator.centroid(e)[1]}).attr("fill","rgba(255, 0, 0, 0.1)").attr("stroke","rgba(255, 0, 0, 0.5)").on("mouseover",e=>{let a=t.totalValCases.filter(t=>t.county.toUpperCase()===e.properties.COUNTY_NAM);$("#county-name").text(a[0].county.toUpperCase()),$("#county-cases").text(numbersWithCommas(a[0].cases));(a=covid_data.filter(t=>t.County.toUpperCase()===e.properties.COUNTY_NAM))[0][t.date];const r=d3.select(event.currentTarget);r.attr("stroke","rgba(255, 0, 0, 0.5)"),r.attr("stroke-width",1),r.style("z-index",1),r.attr("fill","rgba(255, 0, 0, 0.3)")}).on("mouseout",t=>{const e=d3.select(event.currentTarget);toolTip.style("visibility","hidden"),e.style("z-index",0),e.attr("fill","rgba(255, 0, 0, 0.1)")}),t.legend=t.svg.append("g").attr("transform","translate("+(t.width-200)+", "+(t.height-200)+")"),t.svg.selectAll("legend").data(t.radiusScale.ticks(4)).enter().append("circle").attr("cx",t.width-200).attr("cy",e=>t.height-200-t.radiusScale(e)).attr("r",e=>t.radiusScale(e)).attr("fill","none").attr("stroke","rgba(255, 0, 0, 0.5)"),t.svg.selectAll("legend").data(t.radiusScale.ticks(4)).enter().append("line").attr("x1",e=>t.width-200+t.radiusScale(e)).attr("x2",t.width-100).attr("y1",e=>t.height-200-t.radiusScale(e)).attr("y2",e=>t.height-200-t.radiusScale(e)).attr("stroke","grey").attr("stroke-dasharray","2,2"),t.svg.selectAll("legend").data(t.radiusScale.ticks(4)).enter().append("text").style("color","grey").attr("class","text-muted").attr("x",t.width-100).attr("y",e=>t.height-200-t.radiusScale(e)).text(t=>numbersWithCommas(t)).attr("font-size","0.5rem")}}class DonutChart{constructor(t,e,a){this.parentElement=t,this.svgWidth=e,this.svgHeight=a,this.initializeChart()}initializeChart(){const t=this;t.margin={top:20,right:0,bottom:20,left:40},t.height=t.svgHeight-t.margin.top-t.margin.bottom,t.width=t.svgWidth-t.margin.left-t.margin.right,t.radius=Math.min(t.width,t.height)/2,t.t=(()=>d3.transition().ease(d3.easeLinear).duration(1e3)),t.svg=d3.select(t.parentElement).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+t.svgWidth+" "+t.svgHeight).classed(".svg-content",!0),t.donut=t.svg.append("g").attr("height",t.height).attr("width",t.width).attr("id","donut").attr("transform","translate("+(t.width+t.margin.left+t.margin.right)/2+","+(t.height+t.margin.top+t.margin.bottom)/2+")"),t.arc=d3.arc().outerRadius(t.radius).innerRadius(Math.min(t.width,t.height)/2-Math.min(t.width,t.height)/4),t.pie=d3.pie().sort(null).value(t=>t.count),t.pieScale=d3.scaleOrdinal(["blue","red"]),t.wrangleData(),t.svg.append("text").attr("class","title").attr("x",(t.width+t.margin.left+t.margin.right)/2).attr("y",t.margin.top/1.5).attr("text-anchor","middle").style("font-size","1rem").style("text-decoration","underline").text("Smokers Distribution")}wrangleData(t){this.key=$("#var-select").val(),this.code=$("#country-select").val(),this.data=allData[this.code],this.genderArray=["female","male"],this.pieData=[{gender:"female",count:this.data.female_smokers},{gender:"male",count:this.data.male_smokers}],this.updateChart()}updateChart(){const t=this,e=e=>{const a=d3.interpolate(this._current,e);return this._current=a(0),function(e){return t.arc(a(e))}};t.pieScale.domain(t.genderArray),t.donut.selectAll(".arc").remove(),t.curves=t.donut.selectAll(".arc").data(t.pie(t.pieData)),t.curves.transition().duration(750).attrTween("d",e),t.pieChart=t.curves.enter().append("g").attr("class","arc"),t.pieChart.append("path").attr("fill",e=>t.pieScale(e.data.count)).attr("fill-opacity",.2).transition(t.t()).attr("fill-opacity",.7).attrTween("d",e),t.pieLegend=d3.select("#donut").selectAll(".pieLegends").data(t.genderArray).enter().append("g").attr("class","pieLegends").attr("transform",(t,e)=>"translate(75,"+20*e+")"),t.pieLegend.append("rect").attr("x",0).attr("y",0).attr("width",10).attr("height",10).attr("stroke","black").style("fill",e=>t.pieScale(e)),t.pieLegend.append("text").attr("x",20).attr("y",10).attr("class","text-muted").text((t,e)=>t).style("text-anchor","start").style("font-size","0.5rem")}}let barChar,smokersPieChart,kenya,timeline,timeseries;$("#var-select").on("change",()=>{barChart.wrangleData(),timeline.wrangleData()}),$("#country-select").on("change",()=>{barChart.wrangleData(),smokersPieChart.wrangleData(),timeline.wrangleData()}),$("#time-series-country-select").on("change",()=>{"all"===$("#time-series-country-select").val()?timeseries.wrangleData():(timeseries.wrangleData(),timeseries.filterCountry($("#time-series-country-select").val()))}),$("#time-series-date-select").on("change",()=>{timeseries.wrangleData()});const brushed=()=>{const t=(d3.event.selection||timeline.x.range()).map(timeline.x.invert);barChart.wrangleData(t)},toolTip=d3.select("body").append("div").attr("id","tooltip").style("background-color","rgb(139, 166, 106)").style("visibility","hidden"),timeParser=d3.timeParse("%Y-%m-%d"),timeParser2=d3.timeParse("%d/%m/%Y"),formatTime=d3.timeFormat("%A %d %B, %Y"),formatTime_2=d3.timeFormat("%Y-%m-%d"),numbersWithCommas=t=>t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),formatForDisplay=t=>{let e=timeParser2(t);return formatTime(e)},formatForDisplay_2=t=>{let e=timeParser(t);return formatTime(e)},determineTitle=t=>{let e="";switch(t){case"new_deaths":e="New Deaths";break;case"new_tests":e="New Tests";break;case"total_cases":e="Total Cases";break;case"total_deaths":e="Total Deaths";break;case"total_tests":e="Total Tests";break;default:e="New Cases"}return e},formatData=t=>(t.forEach(t=>{"string"==typeof t.date&&(t.date=timeParser(t.date)),t.aged_65_older=+t.aged_65_older,t.aged_70_older=+t.aged_70_older,t.cvd_death_rate=+t.cvd_death_rate,t.diabetes_prevalence=+t.diabetes_prevalence,t.extreme_poverty=+t.extreme_poverty,t.female_smokers=+t.female_smokers,t.gdp_per_capita=+t.gdp_per_capita,t.handwashing_facilities=+t.handwashing_facilities,t.hospital_beds_per_thousand=+t.hospital_beds_per_thousand,t.life_expectancy=+t.life_expectancy,t.male_smokers=+t.male_smokers,t.median_age=+t.median_age,t.new_cases=+t.new_cases,t.new_cases_per_million=+t.new_cases_per_million,t.new_deaths=+t.new_deaths,t.new_deaths_per_million=+t.new_deaths_per_million,t.new_tests=+t.new_tests,t.new_tests_per_thousand=+t.new_tests_per_thousand,t.population=+t.population,t.population_density=+t.population_density,t.stringency_index=+t.stringency_index,t.total_cases=+t.total_cases,t.total_cases_per_million=+t.total_cases_per_million,t.total_deaths=+t.total_deaths,t.total_deaths_per_million=+t.total_deaths_per_million,t.total_tests=+t.total_tests,t.total_tests_per_thousand=+t.total_tests_per_thousand}),t),worldIntialize=t=>{Object.keys(t).map(e=>{"KEN"===e?($("#country-select").append($("<option>").attr("value",e).attr("selected","selected").text(t[e].location)),editInformation(t[e])):$("#country-select").append($("<option>").attr("value",e).text(t[e].location))}),allData=t,allCases=t,barChart=new BarChart("#bar",600,300),timeline=new Timeline("#bar",600,60),smokersPieChart=new DonutChart("#smokers",340,170),$("#country-select").on("change",t=>{const e=$("#country-select").val();editInformation(allCases[e]),timeline.wrangleData()})},editInformation=t=>{"World"===t.location?$("#continent").text(t.location):$("#continent").text(t.continent),$("#population").text(void 0===t.population?"N/A":numbersWithCommas(t.population)),$("#pop-den").text(void 0===t.population_density?"N/A":t.population_density),$("#median-age").text(void 0===t.median_age?"N/A":t.median_age),$("#older").text(void 0===t.aged_65_older?"N/A":t.aged_65_older+"%"),$("#oldest").text(void 0===t.aged_70_older?"N/A":t.aged_70_older+"%"),$("#gdp").text(void 0===t.gdp_per_capita?"N/A":numbersWithCommas(t.gdp_per_capita)),$("#handwash").text(void 0===t.handwashing_facilities?"N/A":t.handwashing_facilities+"%"),$("#beds").text(void 0===t.hospital_beds_per_thousand?"N/A":t.hospital_beds_per_thousand),$("#poverty").text(void 0===t.extreme_poverty?"N/A":t.extreme_poverty+"%"),$("#diabetes").text(void 0===t.diabetes_prevalence?"N/A":t.diabetes_prevalence),$("#life").text(void 0===t.life_expectancy?"N/A":t.life_expectancy),$("#cvd").text(void 0===t.cardiovasc_death_rate?"N/A":t.cardiovasc_death_rate),$("#general-heading").text(t.location+" General Information")},populateKenyaSummary=t=>{const e=t=>t>0?"+"+t:t.toString(),a=t.Kenya,r=a[a.length-1],s=a[a.length-2],n=r.confirmed,i=r.deaths,o=r.recovered,l=r.confirmed-r.recovered-r.deaths,c=r.confirmed-s.confirmed,d=r.deaths-s.deaths,p=r.recovered-s.recovered,m=l-(s.confirmed-s.recovered-s.deaths);$("#kenya-heading small").text("Last update: "+formatForDisplay_2(r.date)),$("#kenya-confirmed small").text(numbersWithCommas(e(c))),$("#kenya-active small").text(numbersWithCommas(e(m))),$("#kenya-recovered small").text(numbersWithCommas(e(p))),$("#kenya-deceased small").text(numbersWithCommas(e(d))),$("#kenya-confirmed .kenya-value").text(numbersWithCommas(n)),$("#kenya-active .kenya-value").text(numbersWithCommas(l)),$("#kenya-recovered .kenya-value").text(numbersWithCommas(o)),$("#kenya-deceased .kenya-value").text(numbersWithCommas(i))},drawMap=(t,e)=>{kenyaMapData=t,covid_data=e;let a=e.columns;a=a.filter(t=>"County"!=t&&""!=t),$("#kenya-last").text("Last update: "+formatForDisplay(a[a.length-1])),$("#kenya-date").attr("min",a[0]).attr("max",a[a.length-1]).attr("value",a[a.length-1]),$("#date-range").attr("min",a[0]),$("#date-range").attr("max",a[a.length-1]),kenya=new KenyaMap("#kenya-map",900,600),$("#kenya-date").on("change",()=>{const t=$("#kenya-date").val();kenya.wrangleData(),$("#kenya-details-container h2").text(formatForDisplay(t)),$("#range-value").text($("#kenya-date").val()),populateDetails(e)})},populateDetails=t=>{const e=t.columns[t.columns.length-1];$("#kenya-details-container h3").text(formatForDisplay(e));let a=[],r=[];a=t.map(t=>{let a={};if("Total"!=t.County){return a={county:t.County,cases:t[e]}}}),r=t.map(t=>{let e={},a=0;if(Object.keys(t).forEach(e=>{"County"!=e&&(a+=t[e])}),"Total"!=t.County){return e={county:t.County,cases:a}}});const s=(t,e)=>{const a=t.cases,r=e.cases;let s=0;return a>r?s=-1:a<r&&(s=1),s};a=a.sort(s).filter(t=>null!=t),r=r.sort(s).filter(t=>null!=t),counties=a.map(t=>{if(null!=t)return t.county}),counties.map(t=>{let e=t.toUpperCase();$("#kenya-details-table").append('<div class="county-row"></div>');let s=$("#kenya-details-table .county-row").last();s.append('<div class="county-name text-muted">'+e+"</div>");const n=a.filter(e=>e.county==t);s.append('<div class="county-today">'+numbersWithCommas(n[0].cases)+"</div>");const i=r.filter(e=>e.county==t);s.append('<div class="county-total">'+numbersWithCommas(i[0].cases)+"</div>")})},drawTimeSeries=t=>{let e=[];Object.entries(t).map(t=>{"OWID_WRL"!=t[0]&&(obj={},obj.country_code=t[0],obj.country=t[1].location,obj.continent=t[1].continent,obj.cases=t[1].data,obj.population=t[1].population,e.push(obj))}),wrkData=e;let a=[],r=[];wrkData.forEach(t=>{r.indexOf(t.continent)<0&&r.push(t.continent),t.cases.map(t=>{a.indexOf(t.date)<0&&a.push(t.date)})}),a=Array.from(new Set(a)),datesObjects=a.map(t=>new Date(t)),datesObjects.sort((t,e)=>t-e),a=datesObjects.map(t=>formatTime_2(t)),r.map(t=>{$("#time-series-continent-select").append($("<option>").attr("value",t).text(t))}),wrkData.map(t=>$("#time-series-country-select").append($("<option>").attr("value",t.country).text(t.country))),$("#time-series-date-select").attr("min",a[0]).attr("max",a[a.length-1]).attr("value",a[a.length-1]),timeseries=new TimeSeries("#time-series",600,300),$("#time-series-continent-select").on("change",()=>{timeseries.wrangleData(),$("#time-series-country-select").empty(),$("#time-series-country-select").append($("<option>").attr("value","all").text("All")),"world"===$("#time-series-continent-select").val()&&wrkData.map(t=>$("#time-series-country-select").append($("<option>").attr("value",t.country).text(t.country))),wrkData.map(t=>{t.continent===$("#time-series-continent-select").val()&&$("#time-series-country-select").append($("<option>").attr("value",t.country).text(t.country))})})};$("document").ready(()=>{NProgress.inc();const t=[d3.json("https://covid.ourworldindata.org/data/owid-covid-data.json"),d3.json("data/counties.json"),d3.csv("data/kenya_daily_covid.csv"),d3.json("https://pomber.github.io/covid19/timeseries.json")];Promise.all(t).then(t=>{worldIntialize(t[0]),drawTimeSeries(t[0]),populateKenyaSummary(t[3]),drawMap(t[1],t[2]),populateDetails(t[2]),setTimeout(()=>{$("#pre-loader").fadeOut("slow",()=>$(this).remove()),NProgress.done(!0)},1500),$("#navigation-bar").addClass("sticky-top")}).catch(t=>{console.log("An error occurred: "),console.log(t)})});